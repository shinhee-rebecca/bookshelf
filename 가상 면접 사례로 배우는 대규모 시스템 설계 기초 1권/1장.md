# 1장 사용자 수에 따른 규모 확장성



## 단일 서버에서 백만 사용자를 보유한 서버까지

![Image](https://github.com/user-attachments/assets/6a7ba254-0a77-4cd2-9a62-5b31bc573866)

#### STEP1 단일 서버

웹 앱, 데이터베이스, 캐시 등이 모두 한 서버에서 실행됨

사용자 수가 많아진다면? : STEP2



#### STEP2 데이터 베이스 서버 분리

웹 앱 서버와 데이터베이스 서버를 분리함

웹 앱 서버에 부하가 많아진다면? : STEP3



#### STEP3 로드 밸런서

부하 분산기

사용자 -- (공개 IP 주소) -- 로드 밸런서 -- (사설 IP 주소) -- 서버

DB 서버를 자유롭게 추가하고 장애를 자동복구 할 수 있도록 하려면? : STEP4



#### STEP4 DB 다중화

장애 자동 복구 및 서버 추가 가능

비싼 연산 결과 및 자주 참조되는 데이터를 저장해두고 싶다면? : STEP5



#### STEP5 Cache

비싼 연산 결과 및 자주 참조되는 데이터를 저장해두어 서버의 성능을 높임

(APP의 성능은 DB를 얼마나 자주 호출하는지에 달림)

동일한 정적 콘텐츠를 자주 읽는다면?



#### STEP6 CDN (콘텐츠 전송 네트워크)

사용자에게 가까운 CDN 서버가 정적 콘텐츠를 전송함

CDN 사용시 제3 사업자 비용과 효율 사이를 잘 고려하고 적절한 만료 시점을 설정하고 미리 장애에 대처를 해두어야 한다.

웹 앱 서버를 수평 확장하고 싶다면? : STEP7



#### STEP7 서버의 상태 정보 제거를 통한 수평 확장

서버에서 상태 정보를 없애 로드 밸런서의 고정 세션 분배에 의한 부담을 없앰

사용자수가 아주 많아진다면? : STEP8



#### STEP8 데이터 센터

geoDNS를 통해 지리적 라우팅을 하여 사용자에게 가까운 데이터 센터로 안내됨



## With



#### DNS (= Domain Name System)

domain name으로 IP 주소를 찾아주는 제3자 유료 서비스



####  DB

- 관계형 vs  비관계형
  - 관계형 : 전통적인 데이터 베이스, 조인 지원
  - 비관계형 : 조인 미지원, 아주 많은 양의 데이터를 저장해야하거나 아주 낮은 응답시간이 요구될 때 사용함
- 스케일
  - 스케일 업 (수직) : 고사양 자원을 사용하는 것 - 한계가 뚜렷하고 자동복구를 지원하지 않음
  - 스케일 아웃 (수평) : 더 많은 수의 서버를 사용하는 것
    - 서버를 추가하는 것을 샤딩(샤드로 분할)이라고 부름
    - 데이터를 고르게 분할하도록 샤딩키 (파티션키)를 정해야 함
    - 샤드 소진 문제, 유명 인사 문제, 조인 등의 문제를 해결해야 함



#### 메세지 큐

소비자나 생산자 중 하나가 다운되어도 괜찮도록 (비동기) 결합을 느슨하게 해주고 데이터의 무손실을 보장해줌
